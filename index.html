<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
<title>XPO Logistics - Registro de Plataformas</title>

<!-- Fuentes -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap" rel="stylesheet">

<!-- jsPDF (PDF) ‚Äî NO SE TOCA -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
/* ============================================
   ESTILO PRINCIPAL
============================================ */
* { 
    margin: 0; 
    padding: 0; 
    box-sizing: border-box; 
}

body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    background-color: #f8fafc;
    color: #1e293b;
    line-height: 1.6;
}

html {
    scroll-behavior: smooth;
}

.app {
    min-height: 100vh;
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

/* ============================================
   HEADER
============================================ */
.header {
    text-align: center;
    margin-bottom: 40px;
    padding: 30px 20px;

    background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
    border-radius: 16px;
    color: white;

    box-shadow: 0 10px 25px rgba(37, 99, 235, 0.2);
    transition: transform 0.3s ease;
}

.code-logo-modern {
    font-size: 1.6rem;
    font-weight: 700;
    color: #111827;
    margin-bottom: 5px;
    letter-spacing: 1px;
}

.logo-modern {
    font-size: 1.4rem;
    font-weight: 600;
    letter-spacing: 1px;
    margin-bottom: 5px;
}

.logo-modern .xpo { color: #ef4444; }
.logo-modern .logistics { color: white; }

.header h1 {
    font-size: 1.8rem;
    font-weight: 600;
}

.date {
    margin-top: 8px;
    font-size: 1rem;
    opacity: 0.9;
}

/* ============================================
   PANTALLA DE BIENVENIDA
============================================ */
.welcome-overlay {
    position: fixed;
    inset: 0;
    background: white;

    display: flex;
    align-items: center;
    justify-content: center;

    z-index: 9999;
    animation: welcomeFadeOut 0.5s ease-out 2.5s forwards;
}

.welcome-box {
    text-align: center;
    animation: fadeSlideIn 0.8s ease-out;
}

.logo-animation {
    font-size: 2rem;
    font-weight: 800;
    color: #ef4444;
    letter-spacing: 2px;
    opacity: 0;
    animation: fadeInLogo 1.2s ease-in forwards;
    animation-delay: 0.5s;
}

#greeting {
    font-family: 'Pacifico', cursive;
    font-size: 3rem;
    background: linear-gradient(90deg, #00C6FF, #3B82F6, #9333EA, #F43F5E, #FF8C00);
    background-size: 400% 400%;
    -webkit-background-clip: text;
    color: transparent;
    animation: gradientShift 8s ease infinite;
    text-shadow: 0 0 10px rgba(255,255,255,0.25);
}

@keyframes fadeInLogo {
    to { opacity: 1; transform: scale(1.05); }
}
@keyframes fadeSlideIn {
    from { opacity: 0; transform: translateY(20px); }
    to   { opacity: 1; transform: translateY(0); }
}
@keyframes welcomeFadeOut {
    to { opacity: 0; visibility: hidden; }
}
@keyframes gradientShift {
    0%   { background-position: 0% 50%; }
    50%  { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

/* ============================================
   FORMULARIO
============================================ */
.form-section,
.summary-section,
.lists-section,
.actions-section {
    background: white;
    border-radius: 12px;
    padding: 30px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.05);
    border: 1px solid #e2e8f0;
}

.form-container { 
    max-width: 500px; 
    margin: 0 auto; 
}

.form { 
    display: flex; 
    flex-direction: column; 
    gap: 20px; 
    text-align: center;
}

.form h2 {
    color: #1e293b;
    font-size: 1.5rem;
    font-weight: 600;
}

.matricula-display {
    background: #f1f5f9;
    padding: 12px;
    border-radius: 8px;
    color: #475569;
}

/* Inputs */
.input, .textarea {
    width: 100%;
    padding: 16px;
    border: 2px solid #e2e8f0;
    border-radius: 8px;
    background: white;
    font-size: 1rem;

    transition: all 0.2s ease;
}

.input:focus,
.textarea:focus {
    outline: none;
    border-color: #2563eb;
    box-shadow: 0 0 0 3px rgba(37,99,235,.1);
    transform: scale(1.02);
}

.textarea {
    resize: vertical;
    min-height: 100px;
}

/* ============================================
   BOTONES
============================================ */
.btn {
    padding: 14px 22px;
    border: none;
    border-radius: 12px;

    cursor: pointer;
    font-weight: 600;

    display: inline-flex;
    justify-content: center;
    align-items: center;

    gap: 8px;
    min-height: 50px;
    font-size: 1rem;

    transition: all 0.3s ease;
    box-shadow: 0 4px 10px rgba(0,0,0,0.08);

    color: white;
}

.btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 14px rgba(0,0,0,0.12);
}

.btn-primary { background: #2563eb; }
.btn-secondary { background: #64748b; }

.btn-cargada  { background: #ef4444; }
.btn-vacia    { background: #10b981; }
.btn-averiada { background: #f59e0b; }

.btn-danger { background: #ef4444; }
.btn-pdf    { background: #7c3aed; }

/* Spinner */
.spinner {
    width: 16px;
    height: 16px;
    border: 2px solid rgba(255,255,255,0.3);
    border-top: 2px solid white;
    border-radius: 50%;
    animation: spin 0.6s linear infinite;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

/* ============================================
   PROGRESO (3 PUNTOS)
============================================ */
.progress-indicator {
    display: flex;
    justify-content: center;
    gap: 10px;
}

.progress-step {
    width: 12px;
    height: 12px;
    background-color: #000;
    border-radius: 50%;
    transition: background 0.3s, transform 0.3s;
}

.progress-step.active {
    background-color: #2563eb;
    transform: scale(1.45);
}

/* ============================================
   RESUMEN
============================================ */
.summary h3 {
    text-align: center;
    margin-bottom: 10px;
}

.summary-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit,minmax(120px,1fr));
    gap: 20px;
}

.stat {
    text-align: center;
    padding: 20px;
    background: #f8fafc;
    border-radius: 12px;
    border: 1px solid #e2e8f0];
}

.stat-number {
    font-size: 2rem;
    font-weight: 700;
    color: #2563eb;
}

.stat-number.animate {
    animation: countBounce 0.5s ease;
}

@keyframes countBounce {
    40% { transform: scale(1.25); }
}

/* ============================================
   LISTAS
============================================ */
.lists-container {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 30px;
}

.platforms-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.platform-card {
    background: #fff;
    border-radius: 12px;
    padding: 14px 18px;
    box-shadow: 0 4px 12px rgba(0,0,0,.06);
    transition: box-shadow .3s, transform .2s;
}

.platform-card:hover {
    box-shadow: 0 8px 20px rgba(0,0,0,.10);
    transform: translateY(-2px);
}

.platform-header {
    display: flex;
    justify-content: space-between;
    margin-bottom: 6px;
}

.empty-message {
    text-align: center;
    color: #64748b;
    font-style: italic;
    padding: 20px;
}

/* ============================================
   BOT√ìN FLOTANTE PDF
============================================ */
.floating-btn {
    position: fixed;
    bottom: 17px;
    right: 15px;

    background: linear-gradient(90deg,#2563eb 0%,#3b82f6 100%);
    color: #fff;

    border: none;
    border-radius: 22px;
    padding: 8px 14px;
    font-weight: 600;
    font-size: .88rem;

    display: flex;
    align-items: center;
    gap: 6px;

    box-shadow: 0 2px 10px rgba(37,99,235,.14);

    cursor: pointer;
    z-index: 1000;

    transition: background .2s, box-shadow .2s, transform .2s;
}

.floating-btn:hover {
    background: linear-gradient(90deg,#1d4ed8 0%,#2563eb 100%);
    transform: translateY(-2px) scale(1.04);
    box-shadow: 0 7px 16px rgba(37,99,235,.19);
}

.floating-btn svg {
    width: 16px;
    height: 16px;
}

/* ============================================
   RESPONSIVE
============================================ */
@media (max-width: 767px) {
    .app { padding: 15px; }

    .lists-container {
        grid-template-columns: 1fr;
    }

    .floating-btn {
        width: 42px;
        height: 42px;
        padding: 6px 7px;
        border-radius: 21px;
        font-size: 0;
    }

    .floating-btn span {
        display: none;
    }
}
</style>
</head>

<body>

<!-- ===========================
     PANTALLA DE BIENVENIDA
=========================== -->
<div class="welcome-overlay" id="welcome-overlay">
    <div class="welcome-box">
        <div class="logo-animation">CODE</div>
        <h2 id="greeting">Bienvenido</h2>
        <p>Bienvenido al sistema de registro de plataformas</p>
    </div>
</div>

<div class="app">

<header class="header">
    <div class="code-logo-modern">CODE</div>

    <div class="logo-modern">
        <span class="xpo">Xpo</span>
        <span class="logistics">Logistics</span>
    </div>

    <h1>Registro de Plataformas</h1>
    <div class="date" id="currentDate"></div>
</header>


<main class="main">

<!-- ===========================
     FORMULARIO (PASOS)
=========================== -->
<section class="form-section fade-in">
    <div class="form-container">

        <div class="progress-indicator">
            <div class="progress-step active" id="stepCircle1"></div>
            <div class="progress-step" id="stepCircle2"></div>
            <div class="progress-step" id="stepCircle3"></div>
        </div>

        <div class="form fade-in-up fade-step" id="step1">
            <h2>Paso 1: Matr√≠cula de la Plataforma</h2>
            <input autocomplete="off" class="input" id="matriculaInput" placeholder="Introduce la matr√≠cula" type="text">
            <button class="btn btn-primary" onclick="nextStep()">Continuar</button>
        </div>

        <div class="form fade-in-up fade-step hidden" id="step2">
            <h2>Paso 2: Estado de la Plataforma</h2>

            <p class="matricula-display">
                Matr√≠cula: <strong id="matriculaDisplay">---</strong>
            </p>

            <div class="estado-buttons">
                <button class="btn btn-cargada" onclick="selectEstado('CARGADA')">CARGADA</button>
                <button class="btn btn-vacia" onclick="selectEstado('VAC√çA')">VAC√çA</button>
                <button class="btn btn-averiada" onclick="selectEstado('AVERIADA')">üõ† AVERIADA</button>
            </div>

            <button class="btn btn-secondary" onclick="resetForm()">Volver</button>
        </div>

        <div class="form fade-in-up fade-step hidden" id="step3">
            <h2>Paso 3: Contenido de la Plataforma</h2>

            <p class="matricula-display">
                Matr√≠cula: <strong id="matriculaDisplay2">---</strong> 
                - Estado: <strong id="estadoDisplay">---</strong>
            </p>

            <textarea class="textarea" id="contenidoInput" placeholder="Describe el contenido o problema..." rows="4"></textarea>

            <div class="form-buttons">
                <button class="btn btn-primary" onclick="registrarPlataforma()">Registrar</button>
                <button class="btn btn-secondary" onclick="goToStep(2)">Volver</button>
            </div>
        </div>

    </div>
</section>


<!-- ===========================
     RESUMEN
=========================== -->
<section class="summary-section fade-in">
    <div class="summary">
        <h3>Resumen del d√≠a</h3>

        <div class="summary-stats">
            <div class="stat">
                <span class="stat-number" id="cargadasCount">0</span>
                <span class="stat-label">Cargadas</span>
            </div>

            <div class="stat">
                <span class="stat-number" id="vaciasCount">0</span>
                <span class="stat-label">Vac√≠as</span>
            </div>

            <div class="stat">
                <span class="stat-number" id="averiadasCount">0</span>
                <span class="stat-label">üõ† Averiadas</span>
            </div>

            <div class="stat">
                <span class="stat-number" id="totalCount">0</span>
                <span class="stat-label">Total</span>
            </div>
        </div>
    </div>
</section>


<!-- ===========================
     LISTAS
=========================== -->
<section class="lists-section fade-in">
    <div class="lists-container">

        <div class="list">
            <h3>Cargadas (<span id="cargadasListCount">0</span>)</h3>
            <div class="platforms-list" id="cargadasList"></div>
        </div>

        <div class="list">
            <h3>Vac√≠as (<span id="vaciasListCount">0</span>)</h3>
            <div class="platforms-list" id="vaciasList"></div>
        </div>

        <div class="list">
            <h3>üõ† Averiadas (<span id="averiadasListCount">0</span>)</h3>
            <div class="platforms-list" id="averiadasList"></div>
        </div>

    </div>
</section>


<!-- ===========================
     ACCIONES
=========================== -->
<section class="actions-section fade-in">
    <div class="actions">
        <button class="btn btn-pdf" onclick="generatePDF()">üìÑ Generar PDF</button>
        <button class="btn btn-danger" onclick="clearData()">üóë Limpiar Registros</button>
    </div>
</section>

<button class="floating-btn" onclick="generatePDF()" title="Generar PDF">
    <svg fill="white" height="16" viewBox="0 0 16 16" width="16">
        <path d="M4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V6.5L9.5 0H4zm5 1.5L13.5 6H10a1 1 0 0 1-1-1V1.5zM4 15a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h4v4a2 2 0 0 0 2 2h4v7a1 1 0 0 1-1 1H4z"/>
    </svg>
    <span>PDF</span>
</button>

</main>
</div>

<script>
/* ===============================
   INIT
=============================== */
window.addEventListener('DOMContentLoaded', () => {
    initGreeting();
    updateDate();
    loadData();
    updateDisplay();
});

/* ===============================
   VARIABLES
=============================== */
let plataformas = [];
let currentStep = 1;
let currentMatricula = '';
let currentEstado = '';

/* ===============================
   SALUDO
=============================== */
function initGreeting() {
    const hour = new Date().getHours();
    const el = document.getElementById('greeting');
    if (!el) return;

    el.textContent =
        hour < 12 ? "Buenos d√≠as üëã" :
        hour < 20 ? "Buenas tardes üëã" :
                    "Buenas noches üåô";
}

/* ===============================
   FECHA
=============================== */
function updateDate() {
    const element = document.getElementById('currentDate');
    if (!element) return;

    const today = new Date();
    const dateString = today.toLocaleDateString('es-ES', {
        weekday: 'long',
        year: 'numeric',
        month: 'long',
        day: 'numeric'
    });

    element.textContent = dateString;
}

/* ===============================
   STORAGE
=============================== */
function getStorageKey() {
    return 'plataformas-global';
}

function loadData() {
    const saved = localStorage.getItem(getStorageKey());
    plataformas = saved ? JSON.parse(saved) : [];
}

function saveData() {
    localStorage.setItem(getStorageKey(), JSON.stringify(plataformas));
}

document.addEventListener('visibilitychange', () => {
    if (document.visibilityState === 'hidden') saveData();
});

window.addEventListener('beforeunload', saveData);

/* ===============================
   PASOS
=============================== */
function goToStep(step) {
    currentStep = step;
    for (let i = 1; i <= 3; i++) {
        document.getElementById('step' + i).classList.add('hidden');
    }
    const el = document.getElementById('step' + step);
    el.classList.remove('hidden');
    animateStepTransition(step);
    updateStepIndicator(step);
}

function animateStepTransition(step) {
    const el = document.getElementById('step' + step);
    el.classList.remove('fade-in');
    void el.offsetWidth;
    el.classList.add('fade-in');
}

function updateStepIndicator(step) {
    const circles = [
        document.getElementById('stepCircle1'),
        document.getElementById('stepCircle2'),
        document.getElementById('stepCircle3')
    ];
    circles.forEach((c, i) => {
        if (!c) return;
        c.classList.toggle('active', i + 1 === step);
    });
}

/* ===============================
   PASO 1 ‚Üí PASO 2
=============================== */
function nextStep() {
    const matricula = document.getElementById('matriculaInput').value.trim();
    if (!matricula) return alert('Por favor, introduce una matr√≠cula v√°lida');

    currentMatricula = matricula.toUpperCase();
    document.getElementById('matriculaDisplay').textContent = currentMatricula;
    document.getElementById('matriculaDisplay2').textContent = currentMatricula;

    goToStep(2);
}

/* ===============================
   PASO 2
=============================== */
function selectEstado(estado) {
    currentEstado = estado;
    const estadoEl = document.getElementById('estadoDisplay');
    if (estadoEl) estadoEl.textContent = estado;

    if (estado === 'VAC√çA') {
        registrarVaciaDirecta();
    } else {
        goToStep(3);
    }
}

function registrarVaciaDirecta() {
    if (!currentMatricula) {
        alert('Introduce una matr√≠cula v√°lida');
        resetForm();
        return;
    }

    const existe = plataformas.some(p =>
        p.matricula === currentMatricula && p.estado === 'VAC√çA'
    );
    if (existe) {
        alert('‚ö†Ô∏è Esta matr√≠cula ya fue registrada como VAC√çA.');
        resetForm();
        return;
    }

    const nueva = {
        id: Date.now(),
        matricula: currentMatricula,
        estado: 'VAC√çA',
        contenido: '',
        timestamp: new Date().toLocaleTimeString('es-ES')
    };
    plataformas.push(nueva);
    saveData();
    updateDisplay();

    resetForm();
}

/* ===============================
   PASO 3
=============================== */
function registrarPlataforma() {
    const contenido = document.getElementById('contenidoInput').value.trim();
    if (!contenido) return alert('Por favor, describe el contenido');

    const nueva = {
        id: Date.now(),
        matricula: currentMatricula,
        estado: currentEstado,
        contenido: contenido,
        timestamp: new Date().toLocaleTimeString('es-ES')
    };

    plataformas.push(nueva);
    saveData();
    updateDisplay();

    resetForm();
}

/* RESET */
function resetForm() {
    currentStep = 1;
    currentMatricula = '';
    currentEstado = '';

    document.getElementById('matriculaInput').value = '';
    document.getElementById('contenidoInput').value = '';

    goToStep(1);
}

/* ===============================
   LISTAS / CONTADORES
=============================== */
function updateDisplay() {
    const cargadas = plataformas.filter(p => p.estado === 'CARGADA');
    const vacias = plataformas.filter(p => p.estado === 'VAC√çA');
    const averiadas = plataformas.filter(p => p.estado === 'AVERIADA');

    animateCount('cargadasCount', cargadas.length);
    animateCount('vaciasCount', vacias.length);
    animateCount('averiadasCount', averiadas.length);
    animateCount('totalCount', plataformas.length);

    document.getElementById('cargadasListCount').textContent = cargadas.length;
    document.getElementById('vaciasListCount').textContent = vacias.length;
    document.getElementById('averiadasListCount').textContent = averiadas.length;

    updateList('cargadasList', cargadas, 'cargada');
    updateList('vaciasList', vacias, 'vacia');
    updateList('averiadasList', averiadas, 'averiada');
}

function updateList(id, items, className) {
    const box = document.getElementById(id);

    if (items.length === 0) {
        const msg =
            className === 'cargada' ? 'cargadas' :
            className === 'vacia'   ? 'vac√≠as' :
                                      'averiadas';

        box.innerHTML = `<div class="empty-message">No hay plataformas ${msg} registradas</div>`;
        return;
    }

    box.innerHTML = items.map(item => `
        <div class="platform-card ${className}">
            <div class="platform-header">
                <span class="platform-matricula">${item.matricula}</span>
                <span class="platform-time">${item.timestamp}</span>
            </div>
            ${item.contenido ? `<div class="platform-content">${item.contenido}</div>` : ''}
        </div>
    `).join('');
}

function animateCount(id, value) {
    const el = document.getElementById(id);
    if (!el) return;

    if (el.textContent != value) {
        el.textContent = value;
        el.classList.add('animate');
        setTimeout(() => el.classList.remove('animate'), 400);
    }
}

/* ===============================
   ELIMINAR TODO
=============================== */
function clearData() {
    if (!confirm('¬øSeguro que deseas eliminar todos los registros?')) return;
    plataformas = [];
    saveData();
    updateDisplay();
}

/* ===============================
   PARALLAX HEADER
=============================== */
window.addEventListener('scroll', () => {
    const header = document.querySelector('.header');
    if (!header) return;

    const y = window.scrollY * 0.2;
    header.style.transform = `translateY(${y}px)`;
});

/* ===============================
   PDF (NO SE TOCA)
=============================== */
function generatePDF() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF({ unit: 'mm', format: 'a4' });

    // ... tu PDF entero original aqu√≠, intacto ...
}
</script>

</body>
</html>